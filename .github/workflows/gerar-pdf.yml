name: Converter todos os Markdown em PDF

on:
  push:
    branches:
      - main  # Executa quando hÃ¡ push na main
  workflow_dispatch:  # Permite execuÃ§Ã£o manual

jobs:
  gerar-pdfs:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ§© Clonar repositÃ³rio
        uses: actions/checkout@v4

      - name: ğŸ§° Instalar Pandoc e LaTeX
        run: |
          sudo apt-get update
          sudo apt-get install -y pandoc texlive texlive-latex-extra

      - name: ğŸ“‚ Criar pasta docs
        run: mkdir -p docs

      - name: ğŸ“ Converter todos os .md em PDFs com margens reduzidas
        run: |
          # Procura todos os arquivos .md no repositÃ³rio, exceto da pasta .git
          find . -type f -name "*.md" ! -path "./.git/*" | while read file; do
            # Gera o nome do PDF correspondente (substitui / por -)
            base=$(basename "$file" .md)
            safe_name=$(echo "$file" | sed 's|^./||; s|/|-|g; s|\.md$||')
            pandoc "$file" -o "docs/${safe_name}.pdf" -V geometry:margin=1cm
            echo "âœ… Gerado: docs/${safe_name}.pdf"
          done

      - name: ğŸ’¾ Upload dos PDFs como artefato (opcional)
        uses: actions/upload-artifact@v4
        with:
          name: PDFs-Gerados
          path: docs/

      # (Opcional) publicar a pasta /docs no GitHub Pages
      # - name: ğŸŒ Publicar PDFs no GitHub Pages
      #   uses: peaceiris/actions-gh-pages@v4
      #   with:
      #     github_token: ${{ secrets.GITHUB_TOKEN }}
      #     publish_dir: ./docs
